<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>最新地震情報</title>
    <script>
        function fetchEarthquakeData() {
            fetch('https://api.p2pquake.net/v2/history?codes=551&limit=1')
                .then(response => response.json())
                .then(data => {
                    if (data && data.length > 0) {
                        const earthquake = data[0].earthquake;
                        const name = earthquake.hypocenter.name; // 震央地名
                        const maxScale = earthquake.maxScale / 10; // 最大震度
                        const time = earthquake.time; // 発生日時

                        // データを表示する
                        document.getElementById('earthquake-info').innerHTML = 
                            `<strong>震央地名:</strong> ${name}<br>` +
                            `<strong>最大震度:</strong> ${maxScale}<br>` +
                            `<strong>発生日時:</strong> ${time}`;
                    }
                })
                .catch(error => console.error('データ取得中のエラー:', error));        
        }
        // 60秒ごとにデータを更新
        setInterval(fetchEarthquakeData, 60000);

        // 初期ロード時にデータ取得
        fetchEarthquakeData();
    </script>
</head>
<body>

    <button id="testButton">test</button>   <!--ボタン-->

    <script>
    document.getElementById('testButton').addEventListener('click', function() {
        setTimeout(function() {
            sendTestData(); // データを送信する関数
            playBuzzer(); // ブザー音を再生する関数
        }, 5000); // 5秒後に実行
    });

    function sendTestData() {
        // データ送信のコードをここに記述
        var xhr = new XMLHttpRequest(); // XMLHttpRequest オブジェクトを作成
        xhr.open("POST", "/path/to/your/server/endpoint", true); // 送信先のURLとメソッドを指定
        xhr.setRequestHeader("Content-Type", "application/json"); // コンテンツタイプを設定
        xhr.onreadystatechange = function() { // レスポンスが返ってきた時の処理を記述
            if (xhr.readyState == 4 && xhr.status == 200) {
                // レスポンスに対する処理
                console.log("データ送信成功");
            }
        };
        var data = JSON.stringify({ message: "Test Data" }); // 送信するデータ
        xhr.send(data); // データを送信
    }

    function playBuzzer() {
        var audio = new Audio('/static/buzzer.mp3');
        audio.play();
    }     
        
    </script>
</body>
</html>

